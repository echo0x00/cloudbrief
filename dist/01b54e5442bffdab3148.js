function action(e){var o=Office.context.mailbox.item;o.itemType===Office.MailboxEnums.ItemType.Message&&(Office.context.ui.displayDialogAsync(url,{width:40,height:60,displayInIframe:!0},(function(e){loginDialog=e.value,loginDialog.addEventHandler(Microsoft.Office.WebExtension.EventType.DialogEventReceived,dialogClosed)})),o.body.setAsync("<p>New HTML content for the email body.</p>",{coercionType:Office.CoercionType.Html},(function(e){e.status===Office.AsyncResultStatus.Failed?console.error("Failed to set body:",e.error.message):console.log("Body content set successfully.")})))}function dialogClosed(e){loginDialog=null,configEvent.completed(),configEvent=null}function itemChanged(e){var o=Office.context.mailbox.item,t="test";console.log("Открыто письмо с темой: ".concat(t)),o.subject.getAsync({asyncContext:o},(function(e){e.status===Office.AsyncResultStatus.Succeeded?(t=e.value,console.log("Открыто письмо с темой: ".concat(t))):console.error("Ошибка получения темы",e.error)})),o.itemType===Office.MailboxEnums.ItemType.Message&&o.body.setAsync("<p>New HTML content for the email body.</p>",{coercionType:Office.CoercionType.Html},(function(e){e.status===Office.AsyncResultStatus.Failed?console.error("Failed to set body:",e.error.message):console.log("Body content set successfully.")}))}Office.onReady((function(){})),Office.initialize=function(e){Office.context.mailbox.item.addHandlerAsync(Office.EventType.ItemChanged,itemChanged)},Office.actions.associate("action",action);